<!DOCTYPE html>
<html>
<head>
    <title>表单实例列表</title>
    <meta charset="utf-8" />
    <title>WEB表单设计器 Ueditor Formdesign</title>
    <link href="css/bootstrap/css/bootstrap.css?2023" rel="stylesheet" type="text/css" />
    <link href="css/jquery.bootgrid.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" charset="utf-8" src="js/jquery-1.7.2.min.js?2023"></script>
    <script type="text/javascript" charset="utf-8" src="js/bootstrap.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/jquery.bootgrid.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/formdesigner.js"></script>
</head>
<body>
    <!--创建表单-->
    <button type="button" class="btn btn-primary" id="newbtn" onclick="createapplication()">填写表单</button>
    <!--表单列表-->
    <div>
        <table id="grid" class="table table-condensed table-hover table-striped" data-selection="true" data-multi-select="true" data-row-select="true" data-keep-selection="true">
            <thead>
                <tr>
                    <th data-column-id="Id" data-identifier="true" data-type="numeric" data-align="right" data-width="40">ID</th>
                    <th data-column-id="FormName" data-order="asc" data-align="center" data-header-align="center" data-width="75%">表单名称</th>
                    <th data-column-id="FormDesc" data-css-class="cell" data-header-css-class="column" data-filterable="true">表单描述</th>
                    <th data-column-id="Modifier" data-visible="false">修改者</th>
                    <th data-column-id="Modified" data-sortable="false" data-width="75px">修改时间</th>
                </tr>
            </thead>
        </table>
    </div>
    <script type="text/javascript">
        var rid = (getUrlParameter('rid')) ? getUrlParameter('rid') : 0;
        //获取json结构
        $.ajax({
            type: 'GET',
            url: './FormService.ashx?atype=getforminstancelist&rid=' + rid,
            dataType: 'json',
            success: function (data) {
                if (data.length > 0) {
                    $("#grid").bootgrid("append", JSON.parse(data)).bootgrid({
                        formatters: {
                            "commands": function (column, row) {
                                return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\">查看实例</span></button> " +
                                    "<button type=\"button\" class=\"btn btn-xs btn-default command-browse\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\">设计表单</span></button> " +
                                    "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-trash-o\">删除</span></button>";
                            }
                        }
                    });
                }
                else { $("#grid").bootgrid(); }
            }
        });

        function createapplication() {
            window.open('application.html?fid=' + rid);
        }
    </script>
</body>
</html>
